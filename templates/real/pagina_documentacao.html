{% extends "base.html" %}

{% block title %}Documentação Técnica | Privacy Shield{% endblock %}

{% block main %}
<div class="doc-container" style="display: grid; grid-template-columns: 280px 1fr; gap: 30px; align-items: start;">

    <aside class="doc-sidebar" style="position: sticky; top: 100px;">
        <div class="card-glow" style="--card-color: var(--primary); padding: 20px;">
            <div class="card-label">Documentação</div>
            <div style="font-weight: 800; color: var(--primary); margin-bottom: 20px;">
                <i class="fas fa-layer-group"></i> Painel Técnico
            </div>

            <nav class="doc-nav" style="display: flex; flex-direction: column; gap: 8px;">
                <button class="doc-btn active" data-target="arquitetura"><i class="fas fa-sitemap"></i> Arquitetura</button>
                <button class="doc-btn" data-target="instalacao"><i class="fas fa-download"></i> Instalação</button>
                <button class="doc-btn" data-target="metodologia"><i class="fas fa-microscope"></i> Metodologia</button>
                <button class="doc-btn" data-target="seguranca"><i class="fas fa-shield-alt"></i> Segurança/LGPD</button>
                <button class="doc-btn" data-target="api"><i class="fas fa-terminal"></i> API Reference</button>
                <hr style="border: 0; border-top: 1px solid #eee; margin: 10px 0;">
                <button class="doc-btn btn-community" data-target="comunidade" style="color: var(--secondary);">
                    <i class="fas fa-comments"></i> Feedback
                </button>
            </nav>
        </div>
    </aside>

    <section class="doc-content-area" id="content-viewport">

        <article id="arquitetura" class="section active">
            <h2 class="section-title" style="color: var(--primary); font-weight: 800; margin-bottom: 20px;">
                <i class="fas fa-sitemap"></i> Arquitetura do Sistema
            </h2>
            <p class="muted" style="line-height: 1.6; margin-bottom: 20px;">
                O <strong>Privacy Shield</strong> opera como um middleware de auditoria, processando fluxos de texto para identificar PII (Personally Identifiable Information).
            </p>



            <div class="impact-grid" style="grid-template-columns: 1fr 1fr; margin-top: 20px;">
                <div class="card-glow" style="--card-color: var(--secondary); padding: 15px;">
                    <div class="card-label">Core Engine</div>
                    <p class="small">Processamento NLP e Regex de alta performance em Python.</p>
                </div>
                <div class="card-glow" style="--card-color: var(--crit-identificadores); padding: 15px;">
                    <div class="card-label">ORM Layer</div>
                    <p class="small">Persistência segura via SQLAlchemy e SQLite.</p>
                </div>
            </div>
        </article>

        <article id="instalacao" class="section" style="display: none;">
            <h2 class="section-title" style="color: var(--primary); font-weight: 800; margin-bottom: 20px;">
                <i class="fas fa-download"></i> Guia de Instalação
            </h2>
            <div style="background: #2d3748; color: #a0aec0; padding: 20px; border-radius: 8px; font-family: 'Courier New', monospace;">
                <p style="color: #68d391; margin-bottom: 10px;"># Clonar e configurar ambiente</p>
                git clone https://github.com/CalebeAF02/Gerenciador-De-Hoteis---UNB.git<br>
                cd Gerenciador-De-Hoteis---UNB<br>
                python -m venv venv<br>
                source venv/bin/activate <span style="color: #ed64a6;"># Linux/Mac</span><br>
                pip install -r requirements.txt
            </div>
        </article>

        <article id="metodologia" class="section" style="display: none;">
            <h2 class="section-title" style="color: var(--primary); font-weight: 800; margin-bottom: 20px;">
                <i class="fas fa-microscope"></i> Metodologia de Detecção
            </h2>
            <div class="impact-grid">
                <div class="card-glow" style="--card-color: var(--success);">
                    <div class="card-label">Matemática</div>
                    <div class="card-value" style="font-size: 1.2rem;">Módulo 11</div>
                    <p class="small">Validação algorítmica de CPF e CNPJ.</p>
                </div>
                <div class="card-glow" style="--card-color: var(--warning);">
                    <div class="card-label">Heurística</div>
                    <div class="card-value" style="font-size: 1.2rem;">Regex</div>
                    <p class="small">Padrões estruturais para e-mails e datas.</p>
                </div>
                <div class="card-glow" style="--card-color: var(--secondary);">
                    <div class="card-label">Semântica</div>
                    <div class="card-value" style="font-size: 1.2rem;">PLN</div>
                    <p class="small">Processamento de Linguagem Natural para nomes.</p>
                </div>
            </div>
        </article>

        <article id="api" class="section" style="display: none;">
            <h2 class="section-title" style="color: var(--primary); font-weight: 800; margin-bottom: 20px;">
                <i class="fas fa-terminal"></i> API Reference
            </h2>
            <div class="card-glow" style="--card-color: var(--text-main); padding: 20px;">
                <span class="badge badge-success">POST</span> <code>/analisar</code>
                <pre style="margin-top:15px; background: #f8f9fa; padding: 10px; border-radius: 5px;">
{
  "texto": "String para análise...",
  "usuario_id": 102
}</pre>
            </div>
        </article>

        <article id="comunidade" class="section" style="display: none;">
            <h2 class="section-title" style="color: var(--primary); font-weight: 800; margin-bottom: 20px;">
                <i class="fas fa-comments"></i> Feedback Técnico
            </h2>
            <form method="POST" action="{{ url_for('documentacao.comentar_documentacao') }}" class="card-glow" style="--card-color: var(--secondary); padding: 25px;">
                <input type="text" name="nome" placeholder="Seu Nome ou Instituição" class="doc-input" style="width: 100%; margin-bottom: 15px; padding: 10px; border-radius: 6px; border: 1px solid #ddd;">
                <textarea name="comentario" placeholder="Descreva sua sugestão ou erro encontrado..." class="doc-textarea" style="width: 100%; height: 100px; padding: 10px; border-radius: 6px; border: 1px solid #ddd; margin-bottom: 15px;"></textarea>
                <button type="submit" class="btn-primary" style="width: 100%;">Enviar para os Desenvolvedores</button>
            </form>

            <div class="comment-list" style="margin-top: 30px;">
                {% for c in comentarios %}
                <div style="border-left: 3px solid var(--primary); padding: 15px; background: white; margin-bottom: 15px; border-radius: 0 8px 8px 0; box-shadow: var(--shadow);">
                    <strong style="color: var(--primary);">{{ c.nome }}</strong> <small class="muted">— {{ c.criado_em }}</small>
                    <p style="margin-top: 8px; font-size: 0.9rem;">{{ c.comentario }}</p>
                </div>
                {% endfor %}
            </div>
        </article>

    </section>
</div>

<style>
    .doc-btn {
        background: transparent;
        border: none;
        padding: 12px 15px;
        text-align: left;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        color: var(--text-muted);
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .doc-btn:hover { background: #f0f4f8; color: var(--primary); }
    .doc-btn.active { background: var(--primary); color: white; }
</style>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const buttons = document.querySelectorAll('.doc-btn');
        const sections = document.querySelectorAll('.section');

        buttons.forEach(btn => {
            btn.addEventListener('click', () => {
                const target = btn.getAttribute('data-target');

                // Esconde todas as seções e remove active dos botões
                sections.forEach(s => s.style.display = 'none');
                buttons.forEach(b => b.classList.remove('active'));

                // Mostra a alvo e ativa o botão
                document.getElementById(target).style.display = 'block';
                btn.classList.add('active');

                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
    });
</script>
{% endblock %}